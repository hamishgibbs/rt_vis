geom_path(aes(x = alpha, y = clustering_coefficient)) +
geom_point(aes(x = alpha, y = clustering_coefficient)) +
facet_wrap(~date) +
theme_bw()
#what are journeys kn Fridays and saturdays that have the highest beviation from baseline?
suppressPackageStartupMessages({
require(sf)
require(tidyverse)
})
if(interactive()){
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/backbone/backbone_summary.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/reports/figures/backbone_comparison')
} else {
.args <- commandArgs(trailingOnly = T)
}
#what are journeys kn Fridays and saturdays that have the highest beviation from baseline?
suppressPackageStartupMessages({
require(sf)
require(tidyverse)
})
if(interactive()){
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/backbone/backbone_summary.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/reports/figures/backbone_comparison')
} else {
.args <- commandArgs(trailingOnly = T)
}
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/backbone/backbone_summary.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/reports/figures/backbone_comparison.png')
if(interactive()){
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/backbone/backbone_summary.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/reports/figures/backbone_comparison')
} else {
.args <- commandArgs(trailingOnly = T)
}
mob <- read_csv(.args[1], col_types = cols(start_quadkey = col_character(), end_quadkey = col_character()))
mob
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/interim/mobility_days.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/reports/figures/backbone_comparison')
if(interactive()){
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/interim/mobility_days.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/reports/figures/backbone_comparison')
} else {
.args <- commandArgs(trailingOnly = T)
}
mob <- read_csv(.args[1], col_types = cols(start_quadkey = col_character(), end_quadkey = col_character()))
mob
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wday %in% c('1', '6', '7'))
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7'))
weekend_mob %>% pull(date) %>% unique()
weekend_mob
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = (n_crisis - n_baseline) / sum(n_crisis, n_baseline))
weekend_mob
a = 10
b = 20
a - b
a / b
(a / b) * 100
(10 / 60) * 100
(10 - 60) / 60
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = (n_crisis - n_baseline) / n_baseline)
weekend_mob
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100)
weekend_mob
weekend_mob %>%
ggplot() +
geom_density(aes(x = perc_change))
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100)
weekend_mob
#%%
weekend_mob %>% group_by(journey) %>%
summarise(n  = n())
journey_line <- function(start_qk, end_qk){
line <- 'a'
return(line)
}
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/interim/mobility_days.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/tile_reference/tiles_zoom_12.shp',)
if(interactive()){
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/interim/mobility_days.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/tile_reference/tiles_zoom_12.shp',)
} else {
.args <- commandArgs(trailingOnly = T)
}
journey_line <- function(start_qk, end_qk){
line <- 'a'
return(line)
}
mob <- read_csv(.args[1], col_types = cols(start_quadkey = col_character(), end_quadkey = col_character()))
tiles <- st_read(.args[2]) %>%
mutate(quadkey = str_pad(quadkey, 12, pad = "0")) %>%
st_set_crs(4326)
if(interactive()){
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/interim/mobility_days.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/tile_reference/tiles_zoom_12.shp',)
} else {
.args <- commandArgs(trailingOnly = T)
}
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/interim/mobility_days.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/tile_reference/tiles_zoom_12.shp')
if(interactive()){
.args <-  c('/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/interim/mobility_days.csv',
'/Users/hamishgibbs/Documents/Covid-19/facebook_mobility_uk/data/processed/tile_reference/tiles_zoom_12.shp')
} else {
.args <- commandArgs(trailingOnly = T)
}
journey_line <- function(start_qk, end_qk){
line <- 'a'
return(line)
}
mob <- read_csv(.args[1], col_types = cols(start_quadkey = col_character(), end_quadkey = col_character()))
tiles <- st_read(.args[2]) %>%
mutate(quadkey = str_pad(quadkey, 12, pad = "0")) %>%
st_set_crs(4326)
tiles <- st_read(.args[2]) %>%
mutate(quadkey = str_pad(quadkey, 12, pad = "0")) %>%
st_set_crs(4326)
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
line <- 'a'
return(line)
}
weekend_mob %>% group_by(journey) %>%
summarise(n  = n())
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100)
weekend_mob %>% pull(journey)
weekend_mob %>% pull(journey, 0)
weekend_mob %>% pull(journey) %>% str_split(., '_')
hf_journeys <- weekend_mob %>% pull(journey) %>% str_split(., '_')
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(start_poly)
line <- 'a'
return(line)
}
hf_journeys[[1]][1]
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
hf_journeys <- weekend_mob %>% pull(journey) %>% str_split(., '_')
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_centroid(start_poly))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_geometry(st_centroid(start_poly)))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
weekend_mob %>%
ggplot() +
geom_density(aes(x = perc_change))
weekend_mob %>%
ggplot() +
geom_density(aes(x = perc_change))
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_coordinates(st_geometry(st_centroid(start_poly))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(c(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly)))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_linestring(c(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_linestring(matrix(c(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly)))))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_linestring(matrix(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_linestring(matrix(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))), nrow = 2)))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(matrix(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly)))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(start_qk, end_qk){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(journey){
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]][1], hf_journeys[[1]][2])
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == start_qk)
end_poly <- tiles %>% filter(quadkey == end_qk)
print(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
line <- 'a'
return(line)
}
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
print(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
line <- 'a'
return(line)
}
journey_line(hf_journeys[[1]])
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly)))))
return(line)
}
journey_line(hf_journeys[[1]])
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressMessages(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
journey_line(hf_journeys[[1]])
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
journey_line(hf_journeys[[1]])
weekend_mob
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100) %>%
mutate(geometry = journey_line(journey))
hf_journeys <- weekend_mob %>% pull(journey) %>% str_split(., '_')
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100) %>%
mutate(geometry = journey_line(journey))
weekend_mob <- mob %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100)
hf_journeys <- weekend_mob %>% pull(journey) %>% str_split(., '_')
lapply(hf_journeys, journey_line)
lapply(hf_journeys[1:10], journey_line)
hf_journeys
hf_journeys <- weekend_mob %>% pull(journey) %>% unique() %>% str_split(., '_')
hf_journeys
data.frame(hf_journeys, lapply(hf_journeys[1:10], journey_line))
data.frame(qk = hf_journeys, geometry = lapply(hf_journeys[1:10], journey_line))
data.frame(qk = hf_journeys, geometry = unlist(lapply(hf_journeys[1:10], journey_line)))
data.frame(qk = hf_journeys[1:10], geometry = unlist(lapply(hf_journeys[1:10], journey_line)))
data.frame('qk' = hf_journeys[1:10], 'geometry' = unlist(lapply(hf_journeys[1:10], journey_line)))
unlist(lapply(hf_journeys[1:10], journey_line))
lapply(hf_journeys[1:10], journey_line)
lapply(hf_journeys[1:10], journey_line) %>%
ggplot() +
geom_sf()
st_sfc(lapply(hf_journeys[1:10], journey_line))
lines <- st_sfc(lapply(hf_journeys[1:10], journey_line))
lines$journey <- hf_journeys[1:10]
lines
lines
lines %>%
ggplot() +
geom_sf
lines %>%
ggplot() +
geom_sf()
lines <- st_sfc(lapply(hf_journeys[1:10], journey_line))
lines
lines$journey <- hf_journeys[1:10]
lines <- st_sfc(lapply(hf_journeys[1:10], journey_line))
st_crs(lines) <- 4326
lines$journey <- hf_journeys[1:10]
lines %>%
ggplot() +
geom_sf()
lines
class(lines)
lines <- st_as_sf(st_sfc(lapply(hf_journeys[1:10], journey_line)))
lines
st_crs(lines) <- 4326
lines$journey <- hf_journeys[1:10]
lines
lines %>%
ggplot() +
geom_sf()
weekend_mob <- mob %>%
filter(start_quadkey != end_quadkey) %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100)
hf_journeys <- weekend_mob %>% pull(journey) %>% unique() %>% str_split(., '_')
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
lines <- st_as_sf(st_sfc(lapply(hf_journeys[1:10], journey_line)))
st_crs(lines) <- 4326
lines$journey <- hf_journeys[1:10]
lines %>%
ggplot() +
geom_sf()
lines <- st_as_sf(st_sfc(lapply(hf_journeys, journey_line)))
st_crs(lines) <- 4326
lines$journey <- hf_journeys
lines %>%
ggplot() +
geom_sf()
require(leaflet)
leaflet(lines) %>%
addTiles()
leaflet(lines) %>%
addTiles() %>%
addPolylines()
weekend_mob <- mob %>%
filter(start_quadkey != end_quadkey) %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 200)
hf_journeys <- weekend_mob %>% pull(journey) %>% unique() %>% str_split(., '_')
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
lines <- st_as_sf(st_sfc(lapply(hf_journeys, journey_line)))
st_crs(lines) <- 4326
lines$journey <- hf_journeys
lines %>%
ggplot() +
geom_sf()
require(leaflet)
leaflet(lines) %>%
addTiles() %>%
addPolylines()
weekend_mob <- mob %>%
filter(date >= as.Date('2020-06-01')) %>%
filter(start_quadkey != end_quadkey) %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 200)
hf_journeys <- weekend_mob %>% pull(journey) %>% unique() %>% str_split(., '_')
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
lines <- st_as_sf(st_sfc(lapply(hf_journeys, journey_line)))
st_crs(lines) <- 4326
lines$journey <- hf_journeys
require(leaflet)
leaflet(lines) %>%
addTiles() %>%
addPolylines()
weekend_mob <- mob %>%
filter(date >= as.Date('2020-04-01')) %>%
filter(start_quadkey != end_quadkey) %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 200)
hf_journeys <- weekend_mob %>% pull(journey) %>% unique() %>% str_split(., '_')
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
lines <- st_as_sf(st_sfc(lapply(hf_journeys, journey_line)))
st_crs(lines) <- 4326
lines$journey <- hf_journeys
require(leaflet)
leaflet(lines) %>%
addTiles() %>%
addPolylines()
weekend_mob <- mob %>%
filter(date >= as.Date('2020-04-01')) %>%
filter(start_quadkey != end_quadkey) %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100)
hf_journeys <- weekend_mob %>% pull(journey) %>% unique() %>% str_split(., '_')
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
lines <- st_as_sf(st_sfc(lapply(hf_journeys, journey_line)))
st_crs(lines) <- 4326
lines$journey <- hf_journeys
require(leaflet)
leaflet(lines) %>%
addTiles() %>%
addPolylines()
weekend_mob <- mob %>%
filter(date >= as.Date('2020-06-01')) %>%
filter(start_quadkey != end_quadkey) %>%
mutate(wkday = as.character(lubridate::wday(date))) %>%
filter(wkday %in% c('1', '6', '7')) %>%
mutate(perc_change = ((n_crisis - n_baseline) / n_baseline) * 100) %>%
filter(perc_change > 100)
hf_journeys <- weekend_mob %>% pull(journey) %>% unique() %>% str_split(., '_')
journey_line <- function(journey){
journey <- str_split(journey, '_')
start_poly <- tiles %>% filter(quadkey == journey[1])
end_poly <- tiles %>% filter(quadkey == journey[2])
line <- suppressWarnings(st_linestring(rbind(st_coordinates(st_geometry(st_centroid(start_poly))), st_coordinates(st_geometry(st_centroid(end_poly))))))
return(line)
}
lines <- st_as_sf(st_sfc(lapply(hf_journeys, journey_line)))
st_crs(lines) <- 4326
lines$journey <- hf_journeys
require(leaflet)
leaflet(lines) %>%
addTiles() %>%
addPolylines()
